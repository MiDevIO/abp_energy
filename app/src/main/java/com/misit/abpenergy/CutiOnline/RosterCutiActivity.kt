package com.misit.abpenergy.CutiOnlineimport android.graphics.Colorimport androidx.appcompat.app.AppCompatActivityimport android.os.Bundleimport android.util.Logimport android.view.Viewimport com.github.sundeepk.compactcalendarview.CompactCalendarViewimport com.github.sundeepk.compactcalendarview.domain.Eventimport com.misit.abpenergy.Rimport kotlinx.android.synthetic.main.activity_form_cuti.*import java.text.SimpleDateFormatimport java.util.*class RosterCutiActivity : AppCompatActivity(),View.OnClickListener {    private var TAG= "CutiOnline"    lateinit var compactCalendarView:CompactCalendarView    private var dateMouthFormat : SimpleDateFormat = SimpleDateFormat("MMMM - yyyy", Locale.getDefault())    private var formatDate = SimpleDateFormat("dd-MM-yyyy",Locale.getDefault())    private var dateFormat = SimpleDateFormat("dd MMMM yyyy",Locale.getDefault())    var date = Calendar.getInstance()    var eventClick:List<Event>?=null    var tglmulai = "01-07-2021"    var tglSampai = "14-07-2021"    var dateEvent:List<Event>?=null    override fun onCreate(savedInstanceState: Bundle?) {        super.onCreate(savedInstanceState)        setContentView(R.layout.activity_roster_cuti)        title = "Roster Cuti"        var currDate = Date()        compactCalendarView = findViewById<View>(R.id.compactcalendar_view) as CompactCalendarView        compactCalendarView.setUseThreeLetterAbbreviation(true)        compactCalendarView.setFirstDayOfWeek(Calendar.MONDAY)        var cutidateDari=  formatDate.parse(tglmulai)        var cutidateSampai=  formatDate.parse(tglSampai)        var eventArr = datesBetween(cutidateDari,cutidateSampai)        compactCalendarView.addEvents(eventArr)        dateEvent = compactCalendarView.getEvents(currDate.time)        if(dateEvent!!.size > 0) {            dateEvent?.forEach {                tvEvent.text = it.data.toString()                tvEvent.setTextColor(it.color)            }        }else{            tvEvent.text = ""        }        titleCalendarView.text = dateMouthFormat.format(date.time)        compactCalendarView.setListener(object: CompactCalendarView.CompactCalendarViewListener{            override fun onDayClick(dateClicked: Date?) {                var dateEvent = compactCalendarView.getEvents(dateClicked)                if(dateEvent.size>0){                    dateEvent.forEach {                        if(dateClicked!!.time == it.timeInMillis && it.data.toString()!=null){                            tvEvent.text = it.data.toString()                            tvEvent.setTextColor(it.color)                        }else{                            tvEvent.text = ""                        }                    }                }else{                    tvEvent.text = ""                }                Log.d(TAG,dateEvent.toString())            }            override fun onMonthScroll(firstDayOfNewMonth: Date?) {                titleCalendarView.text = dateMouthFormat.format(firstDayOfNewMonth)            }        })        btnPrefCal.setOnClickListener(this)        btnNextCal.setOnClickListener(this)    }    override fun onClick(v: View?) {        if(v?.id==R.id.btnPrefCal){            compactCalendarView.scrollLeft()        }        if(v?.id==R.id.btnNextCal){            compactCalendarView.scrollRight()        }    }    private fun datesBetween(startDate: Date, endDate: Date) :List<Event> {        var intial = startDate        var list = arrayListOf<Event>()        val c = Calendar.getInstance()        c.time = intial        while (intial <= endDate){            list.add(Event(Color.RED, c.timeInMillis,"Cuti Roster ${dateFormat.format(startDate)} - ${dateFormat.format(endDate)}"))            c.add(Calendar.DATE,1)            intial = c.time        }        return list    }}