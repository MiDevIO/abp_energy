package com.misit.abpenergy.Loginimport android.app.Activityimport android.content.Intentimport androidx.appcompat.app.AppCompatActivityimport android.os.Bundleimport androidx.recyclerview.widget.LinearLayoutManagerimport com.misit.abpenergy.Api.ApiClientimport com.misit.abpenergy.Api.ApiEndPointimport com.misit.abpenergy.Login.Adapter.SectionListAdapterimport com.misit.abpenergy.Login.Response.SectionItemimport com.misit.abpenergy.Login.Response.SectionResponseimport com.misit.abpenergy.Rimport es.dmoral.toasty.Toastyimport kotlinx.android.synthetic.main.activity_section.*import retrofit2.Callimport retrofit2.Callbackimport retrofit2.Responseclass SectionActivity : AppCompatActivity(),SectionListAdapter.OnItemClickListener {    private var adapter: SectionListAdapter? = null    private var devisiList:MutableList<SectionItem>?=null    private var idSect:String?=null    private var devisi:String?=null    private var idDept:String?=null    override fun onCreate(savedInstanceState: Bundle?) {        super.onCreate(savedInstanceState)        setContentView(R.layout.activity_section)        title= getString(R.string.section_devisi)        idDept = intent.getStringExtra(ID_DEPARTEMEN)        devisiList= ArrayList()        adapter = SectionListAdapter(            this,            devisiList!!        )        val linearLayoutManager = LinearLayoutManager(this)        rvDevisi?.layoutManager = linearLayoutManager        rvDevisi.adapter =adapter        adapter?.setListener(this)        loadData(idDept!!)    }    override fun onSupportNavigateUp(): Boolean {        onBackPressed()        return super.onSupportNavigateUp()    }    private fun loadData(idDept:String) {        val apiEndPoint =            ApiClient.getClient(this@SectionActivity)!!.create(ApiEndPoint::class.java)        val call = apiEndPoint.checkSection(idDept)        call?.enqueue(object : Callback<SectionResponse?> {            override fun onResponse(                call: Call<SectionResponse?>,                response: Response<SectionResponse?>            ) {                var r = response.body()                if(r!=null){                    if (r.section!=null){                        devisiList?.addAll(r.section!!)                        adapter?.notifyDataSetChanged()                    }                }            }            override fun onFailure(call: Call<SectionResponse?>, t: Throwable) {                Toasty.error(this@SectionActivity,"Error "+t.printStackTrace().toString()).show()            }        })    }    override fun onItemClick(idSect: String?, devisi: String?) {        var intent = Intent()        intent.putExtra("DEVISI",devisi)        intent.putExtra("ID_DEVISI",idSect)        setResult(Activity.RESULT_OK,intent)        finish()    }    companion object{        var ID_DEPARTEMEN = "ID_DEPARTEMEN"    }}