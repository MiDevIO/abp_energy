package com.misit.abpenergy.Loginimport android.app.Activityimport android.content.Intentimport androidx.appcompat.app.AppCompatActivityimport android.os.Bundleimport android.util.Logimport android.view.Windowimport android.view.WindowManagerimport androidx.core.content.ContextCompatimport androidx.recyclerview.widget.LinearLayoutManagerimport com.misit.abpenergy.Api.ApiClientimport com.misit.abpenergy.Api.ApiEndPointTwoimport com.misit.abpenergy.Login.Adapter.DepartmentAdapaterimport com.misit.abpenergy.Login.Response.CompanyResponseimport com.misit.abpenergy.Login.Response.DepartmentItemimport com.misit.abpenergy.Login.Response.DepartmentResponseimport com.misit.abpenergy.Rimport com.misit.abpenergy.Utils.PopupUtilimport es.dmoral.toasty.Toastyimport kotlinx.android.synthetic.main.activity_department.*import retrofit2.Callimport retrofit2.Callbackimport retrofit2.Responseclass DepartmentActivity : AppCompatActivity(),DepartmentAdapater.OnItemClickListener {    private var adapter: DepartmentAdapater? = null    private var deptList:MutableList<DepartmentItem>?=null    private var idDept:String?=null    private var idCompany:String?=null    private var deptDipilih:String?=null    override fun onCreate(savedInstanceState: Bundle?) {        super.onCreate(savedInstanceState)        setContentView(R.layout.activity_department)        title= "Departemen"        deptDipilih = intent.getStringExtra("deptDipilih")        idCompany = intent.getStringExtra("idCompany")        val window: Window = this.window        window.addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS)        window.clearFlags(WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS)        window.statusBarColor = ContextCompat.getColor(this@DepartmentActivity, R.color.colorPrimary)        var actionBar = supportActionBar        actionBar?.setDisplayHomeAsUpEnabled(true)        deptList= ArrayList()        adapter = DepartmentAdapater(this@DepartmentActivity,deptDipilih!!,deptList!!)        val linearLayoutManager = LinearLayoutManager(this@DepartmentActivity)        rvDepartment?.layoutManager = linearLayoutManager        rvDepartment.adapter =adapter        adapter?.setListener(this)        loadData()    }    private fun loadData() {        PopupUtil.showProgress(this@DepartmentActivity,"Loading...","Memuat Data Departemen!")        val apiEndPoint = ApiClient.getClient(this)!!.create(ApiEndPointTwo::class.java)        val call = apiEndPoint.getDepartment(idCompany!!)        call?.enqueue(object : Callback<DepartmentResponse> {            override fun onResponse(                call: Call<DepartmentResponse>,                response: Response<DepartmentResponse>            ) {                var r = response.body()                if(r!=null){                    deptList?.addAll(r.department!!)                    adapter?.notifyDataSetChanged()                    PopupUtil.dismissDialog()                }else{                    Toasty.error(this@DepartmentActivity,"Perusahaan Tidak Ditemukan!").show()                    PopupUtil.dismissDialog()                }            }            override fun onFailure(call: Call<DepartmentResponse>, t: Throwable) {                Log.d("ErrorDepartment",t.toString())            }        })    }    override fun onItemClick(idDept: String?, dept: String?) {        val intent = Intent()        intent.putExtra("deptDipilih",dept)        intent.putExtra("idDept",idDept)        setResult(Activity.RESULT_OK,intent)        finish()    }    override fun onSupportNavigateUp(): Boolean {        onBackPressed()        return super.onSupportNavigateUp()    }}